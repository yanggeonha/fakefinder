<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAN - 위조지폐 찾기 게임</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 메인 화면 (방 생성/찾기) -->
    <div id="main" class="screen active">
        <h1 class="main-title">GAN</h1>
        <h2 class="sub-title">위조지폐 찾기 게임</h2>
        <p class="subtitle">감별사 vs 위조지폐범 - 실시간 멀티플레이어 추리 게임</p>

        <div class="main-buttons">
            <div class="main-card create-room-card" onclick="showCreateRoom()">
                <div class="card-icon">🏠</div>
                <h2>방 생성하기</h2>
                <p>선생님용 - 새로운 게임 방을 만들고 감별사가 됩니다</p>
            </div>
            <div class="main-card join-room-card" onclick="showJoinRoom()">
                <div class="card-icon">🔍</div>
                <h2>방 찾기</h2>
                <p>학생용 - 핀번호를 입력하여 게임에 참가합니다</p>
            </div>
        </div>
    </div>

    <!-- 방 생성 화면 -->
    <div id="createRoom" class="screen">
        <h1>방 생성하기</h1>
        <p class="subtitle">새로운 게임 방을 만듭니다 (감별사 역할)</p>

        <div class="room-setup">
            <input type="text" id="hostNameInput" placeholder="선생님 이름 (예: 1반 선생님)" maxlength="15">
            <button class="create-btn" onclick="createRoom()">방 만들기</button>
            <button class="back-btn" onclick="showMain()">뒤로가기</button>
        </div>
    </div>

    <!-- 방 찾기 화면 -->
    <div id="joinRoom" class="screen">
        <h1>방 찾기</h1>
        <p class="subtitle">핀번호를 입력하여 게임에 참가합니다</p>

        <div class="room-setup">
            <input type="text" id="pinInput" placeholder="6자리 핀번호" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '')">
            <input type="text" id="playerNameInput" placeholder="닉네임" maxlength="10">
            <button class="join-btn" onclick="joinRoom()">입장하기</button>
            <button class="back-btn" onclick="showMain()">뒤로가기</button>
        </div>
    </div>

    <!-- 로비 화면 -->
    <div id="lobby" class="screen">
        <h1>위조지폐 찾기 게임</h1>
        <div class="pin-display">
            <span>핀번호:</span>
            <strong id="roomPinCode">000000</strong>
            <button class="copy-btn" onclick="copyPinCode()">복사</button>
        </div>

        <div class="lobby-content">
            <div class="team-setup joined-info" id="joinedSection">
                <h2>입장 완료!</h2>
                <p>이름: <strong id="myTeamName"></strong></p>
                <p>역할: <strong id="myRole"></strong></p>
                <p class="waiting-msg">다른 팀들을 기다리는 중...</p>
            </div>

            <div class="team-list">
                <h3>참가자 (<span id="teamCount">0</span>/30)</h3>
                <ul id="teamList"></ul>
            </div>

            <button id="startGameBtn" class="start-btn" onclick="startGame()" disabled style="display: none;">
                게임 시작 (위조지폐범 필요)
            </button>
        </div>
    </div>

    <!-- 게임 화면 -->
    <div id="game" class="screen">
        <div class="game-header">
            <div class="stage-round-info">
                <span class="stage-badge"><span id="currentStage">1</span>단계</span>
                <span>라운드 <span id="currentRound">1</span>/5</span>
            </div>
            <div class="phase-info">
                <span id="phaseText">위조지폐 제작 단계</span>
            </div>
            <div class="timer-container">
                <span id="timer">30</span>초
            </div>
        </div>

        <div class="game-main-container">
            <div class="game-main">
                <div class="current-turn">
                    <h2 id="turnInfo">감별사의 차례</h2>
                    <p id="roleInfo">역할: 감별사</p>
                </div>

                <!-- 지폐 디자인 영역 -->
                <div class="bill-container">
                    <div class="bill" id="billElement" data-amount="10000">
                        <div class="bill-top">
                            <div class="bank-name">한국은행</div>
                            <div class="bank-name-en">BANK OF KOREA</div>
                        </div>

                        <div class="bill-main">
                            <div class="bill-left">
                                <div class="portrait-area" id="portraitArea">
                                    <div class="portrait-placeholder">인물</div>
                                </div>
                            </div>

                            <div class="bill-center">
                                <div id="billGrid" class="bill-grid"></div>
                            </div>

                            <div class="bill-right">
                                <div class="amount-display" id="amountDisplay">10000</div>
                                <div class="amount-unit">원</div>
                            </div>
                        </div>

                        <div class="bill-bottom">
                            <div class="serial-area">AB12345678가</div>
                            <div class="watermark-area">
                                <span class="watermark-icon">◐</span>
                            </div>
                            <div class="hologram-area">
                                <span class="hologram-icon">◈</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 금액 선택 -->
                <div class="amount-selector">
                    <label>금액 선택:</label>
                    <select id="amountSelect" class="amount-select" onchange="changeAmount(this.value)">
                        <option value="1000">1,000원 (이황)</option>
                        <option value="5000">5,000원 (이이)</option>
                        <option value="10000" selected>10,000원 (세종대왕)</option>
                        <option value="50000">50,000원 (신사임당)</option>
                    </select>
                </div>

                <!-- 요소 선택 패널 -->
                <div class="element-panel" id="elementPanel">
                    <h3 id="elementPanelTitle">배치할 요소 선택</h3>
                    <div class="elements"></div>
                    <p class="hint">요소를 선택한 후 격자를 클릭하세요</p>
                </div>

                <!-- 대기 메시지 -->
                <div class="waiting-message" id="waitingMessage" style="display: none;">
                    <h3>감별사가 위조지폐를 만드는 중...</h3>
                    <p>잠시만 기다려주세요.</p>
                </div>

                <!-- 제출 현황 -->
                <div class="submission-status" id="submissionStatus" style="display: none;">
                    <h3>제출 현황</h3>
                    <p><span id="submittedCount">0</span> / <span id="totalCounterfeiters">0</span> 팀 제출</p>
                    <ul id="submittedList"></ul>
                </div>

                <button id="submitBtn" class="submit-btn" onclick="submitBill()">제출하기</button>
                <p id="alreadySubmitted" class="submitted-msg" style="display: none;">제출 완료! 다른 팀을 기다리는 중...</p>
            </div>

            <!-- 오른쪽 라운드 결과 패널 -->
            <div class="round-results-panel" id="roundResultsPanel">
                <h3>라운드 결과</h3>
            </div>
        </div>
    </div>

    <!-- 결과 화면 -->
    <div id="result" class="screen">
        <h2 id="resultTitle">결과</h2>
        <div id="originalBill" class="result-bill-container">
            <h3>원본 위조지폐 (감별사)</h3>
            <div class="result-bill" id="originalBillDisplay"></div>
        </div>
        <div id="resultList" class="result-list"></div>
        <button id="nextRoundBtn" class="next-btn" onclick="nextRound()">다음 라운드</button>
        <p id="waitingNextRoundMsg" class="waiting-msg" style="display: none;">감별사가 다음 라운드를 시작할 때까지 기다려주세요...</p>
        <button id="restartBtn" class="restart-btn" onclick="restartGame()" style="display:none;">처음부터</button>
    </div>

    <!-- 단계 시작 대기 화면 -->
    <div id="stageStart" class="screen">
        <h1 id="stageStartTitle">1단계 완료!</h1>
        <p class="stage-subtitle" id="stageStartSubtitle">2단계를 시작할 준비가 되었습니다.</p>
        <button id="startNextStageBtn" class="start-btn" onclick="startNextStage()" style="display: none;">2단계 시작</button>
        <p id="waitingForAppraiserMsg" class="waiting-msg">감별사가 다음 단계를 시작할 때까지 기다려주세요...</p>
    </div>

    <!-- 최종 결과 화면 -->
    <div id="finalResult" class="screen">
        <h1>🏆 최종 결과 🏆</h1>
        <p class="final-subtitle">3단계 15라운드 완료!</p>
        <div id="finalScores" class="final-scores"></div>
        <div id="winner" class="winner"></div>
        <button class="restart-btn" onclick="restartGame()">처음부터</button>
    </div>

    <!-- 에러 토스트 -->
    <div id="toast" class="toast"></div>

    <!-- 푸터 -->
    <footer class="site-footer">(주)몬스터 캠퍼스</footer>

    <script src="/socket.io/socket.io.js"></script>
    <script src="game.js"></script>
</body>
</html>
